<body style="margin:0">
<ins data-dcm-click-tracker='%%CLICK_URL_UNESC%%' class='dcmads' style='display:inline-block;width:300px;height:600px'
    data-dcm-placement='N2380205.5817241MOYO/B34441223.432351318'
    data-dcm-rendering-mode='iframe'
    data-dcm-https-only
    data-dcm-api-frameworks='[APIFRAMEWORKS]'
    data-dcm-omid-partner='[OMIDPARTNER]'
    data-dcm-gdpr-applies='gdpr=${GDPR}'
    data-dcm-gdpr-consent='gdpr_consent=${GDPR_CONSENT_755}'
    data-dcm-addtl-consent='addtl_consent=${ADDTL_CONSENT}'
    data-dcm-ltd='false'
    data-dcm-resettable-device-id=''
    data-dcm-app-id=''>
  <script src='https://www.googletagservices.com/dcm/dcmads.js'></script>
</ins>
<!-- NO_REFRESH -->

<script>
    var iframeEl = window.frameElement;
    var iframeParentEl0 = iframeEl.parentElement;
    var iframeParentEl1 = iframeEl.parentElement.parentElement;
    var iframeParentEl2 = iframeEl.parentElement.parentElement.parentElement;
    var iframeParentEl3 = iframeEl.parentElement.parentElement.parentElement.parentElement;
    
// Freeze effect
function isInView(element) {
  var rect = element.getBoundingClientRect();
  var centerY = rect.top + (rect.height / 2); // get center of Y
  var viewportCenterY = ((window.parent.innerHeight || window.parent.documentElement.clientHeight) / 2)-15;
  var tolerance = 30; // adjust this value to change the tolerance
  console.log(`Current Center Y: ${centerY}`);
  console.log(`Viewport Center Y: ${viewportCenterY}`);

  return (
    centerY >= viewportCenterY - tolerance &&
    centerY <= viewportCenterY + tolerance
  );
}

var isElementInView = false;
function freezeAd() {
    var rect = iframeParentEl0.getBoundingClientRect();
    if (!isElementInView && isInView(iframeParentEl0)) {
        isElementInView = true;
        console.log(`${iframeParentEl1.id} is VIEWABLE`);
        window.parent.document.getElementsByTagName("body")[0].classList.add('frozenB');
        setTimeout(function() {
            window.parent.document.getElementsByTagName("body")[0].classList.remove('frozenB');
        }, 3000); // 3 seconds
    } 
}    
    
function removeAdRailBox() {
    if (iframeParentEl1.classList.contains('ad-rail-box600')) {
        iframeParentEl1.classList.remove('ad-rail-box600');
        console.log('Remove .rail-box-600');
    }
}
    
removeAdRailBox();
window.parent.addEventListener('scroll', function() {
  freezeAd();
});

// Add CSS for freeze effect
var styleFreeze = document.createElement('style');
styleFreeze.innerHTML = `
  .frozenB {
    overflow: hidden !important;
  }
`;
    
//inline style
var referenceElement         = iframeParentEl0;
referenceElement.appendChild(styleFreeze);
</script>
</body>